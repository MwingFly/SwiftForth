{ ====================================================================
Scaled table of integer sine values

Copyright (C) 2001 FORTH, Inc.  All rights reserved.
==================================================================== }

OPTIONAL SINE Scaled table of integer sine values

1000000 CONSTANT ONE    \ the scaling factor for sin/cos values

CREATE SINES
   000000 ,  017452 ,  034899 ,  052336 ,  069756 ,
   087156 ,  104528 ,  121869 ,  139173 ,  156434 ,
   173648 ,  190809 ,  207912 ,  224951 ,  241922 ,
   258819 ,  275637 ,  292372 ,  309017 ,  325568 ,
   342020 ,  358368 ,  374607 ,  390731 ,  406737 ,
   422618 ,  438371 ,  453990 ,  469472 ,  484810 ,
   500000 ,  515038 ,  529919 ,  544639 ,  559193 ,
   573576 ,  587785 ,  601815 ,  615661 ,  629320 ,
   642788 ,  656059 ,  669131 ,  681998 ,  694658 ,
   707107 ,  719340 ,  731354 ,  743145 ,  754710 ,
   766044 ,  777146 ,  788011 ,  798636 ,  809017 ,
   819152 ,  829038 ,  838671 ,  848048 ,  857167 ,
   866025 ,  874620 ,  882948 ,  891007 ,  898794 ,
   906308 ,  913545 ,  920505 ,  927184 ,  933580 ,
   939693 ,  945519 ,  951057 ,  956305 ,  961262 ,
   965926 ,  970296 ,  974370 ,  978148 ,  981627 ,
   984808 ,  987688 ,  990268 ,  992546 ,  994522 ,
   996195 ,  997564 ,  998630 ,  999391 ,  999848 ,  1000000 ,

: SIN ( angle -- sin*one )
   180 /MOD >R DUP 90 > IF  180 - NEGATE  THEN
   CELLS SINES + @  R> 1 AND IF  NEGATE  THEN ;

: COS ( angle -- cos*one )   90 + SIN ;

{ --------------------------------------------------------------------
Testing
-------------------------------------------------------------------- }

EXISTS RELEASE-TESTING [IF]

: TEST
   360 0 DO
      I 64 360 */ 16 I SIN 15 ONE */ - AT-XY [CHAR] * EMIT
      I 64 360 */ 16 I COS 15 ONE */ - AT-XY [CHAR] # EMIT
   LOOP ;

TEST

KEY DROP   [THEN]
